#!/bin/bash
# -*- shell-script -*-
t=${0##*/}; TEST_NAME=${t:5}   # basename $0 with 'test-' stripped off
# Test restart command

[ -z "$builddir" ] && export builddir=$PWD
. ${builddir}/check-common.sh
debugged_script="$top_builddir/test/example/restartbug.sh"

(cd $srcdir && run_debugger $debugged_script 2>&1 >$TEST_FILE </dev/null)

cat ${TEST_FILE} | sed -e "s|restart -B --no-init -q -L.*restartbug.sh|restart -B --no-init -q -L ... restartbug.sh|" | sed -e "s|Restarting with.*restartbug.sh|Restarting with ... restartbug.sh|" >${TEST_FILTERED_FILE}

check_output $TEST_FILTERED_FILE $RIGHT_FILE
rc=$?
exit $rc
