#!@SH_PROG@ -f
t=${0##*/}; TEST_NAME=${t:5}   # basename $0 with 'test-' stripped off

[ -z "$builddir" ] && export builddir=$PWD
. ${builddir}/check-common.sh

(cd $srcdir && $SH ${srcdir}/${TEST_NAME}.tests > $TEST_FILE 2>&1 < /dev/null)

cat ${TEST_FILE} | @SED@ -e "s:-L .* -x .*/data/setshow\.cmd .*/example/dbg-test2.sh:-L .. -x data/setshow.cmd example/dbg-test2.sh:" \
| @SED@ -e 's:record the command history is .*:record the command history is: ' \
> ${TEST_FILTERED_FILE}

check_output $TEST_FILTERED_FILE $RIGHT_FILE
rc=$?

((0 != rc)) && exit $rc
rm -f $TEST_FILE

# Return code tells testing mechanism whether passed or not.
exit 0
